import pandas as pd

# Fresh ICM data (filtered: no SCIM Escalation Management)
icm_data = [
{'IncidentId': 554844287, 'Severity': 3, 'OwningContactAlias': '', 'Status': 'RESOLVED'},
{'IncidentId': 595818712, 'Severity': 3, 'OwningContactAlias': 'nassersa', 'Status': 'RESOLVED'},
{'IncidentId': 616208690, 'Severity': 4, 'OwningContactAlias': '', 'Status': 'RESOLVED'},
{'IncidentId': 616515906, 'Severity': 3, 'OwningContactAlias': 'v-srikantamr', 'Status': 'RESOLVED'},
{'IncidentId': 628032426, 'Severity': 3, 'OwningContactAlias': '', 'Status': 'RESOLVED'},
{'IncidentId': 650527915, 'Severity': 3, 'OwningContactAlias': '', 'Status': 'RESOLVED'},
{'IncidentId': 659601256, 'Severity': 3, 'OwningContactAlias': 'v-roymithun', 'Status': 'RESOLVED'},
{'IncidentId': 664019513, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'RESOLVED'},
{'IncidentId': 670828774, 'Severity': 3, 'OwningContactAlias': 'v-srikantamr', 'Status': 'RESOLVED'},
{'IncidentId': 675908430, 'Severity': 3, 'OwningContactAlias': 'harsjain', 'Status': 'MITIGATED'},
{'IncidentId': 676151538, 'Severity': 3, 'OwningContactAlias': 'v-raputta', 'Status': 'RESOLVED'},
{'IncidentId': 680275765, 'Severity': 3, 'OwningContactAlias': 'v-raputta', 'Status': 'RESOLVED'},
{'IncidentId': 681780305, 'Severity': 3, 'OwningContactAlias': 'jeastorg', 'Status': 'RESOLVED'},
{'IncidentId': 686606637, 'Severity': 3, 'OwningContactAlias': 'samadaan', 'Status': 'RESOLVED'},
{'IncidentId': 686924487, 'Severity': 3, 'OwningContactAlias': 'satgupta', 'Status': 'RESOLVED'},
{'IncidentId': 687188371, 'Severity': 3, 'OwningContactAlias': 'v-raputta', 'Status': 'RESOLVED'},
{'IncidentId': 692107101, 'Severity': 3, 'OwningContactAlias': 'darshanarana', 'Status': 'RESOLVED'},
{'IncidentId': 692576978, 'Severity': 3, 'OwningContactAlias': 'v-roymithun', 'Status': 'RESOLVED'},
{'IncidentId': 692949242, 'Severity': 3, 'OwningContactAlias': 'akandarpa', 'Status': 'ACTIVE'},
{'IncidentId': 693543577, 'Severity': 25, 'OwningContactAlias': 'rexzh', 'Status': 'RESOLVED'},
{'IncidentId': 693849812, 'Severity': 2, 'OwningContactAlias': 'soalves', 'Status': 'ACTIVE'},
{'IncidentId': 693952482, 'Severity': 3, 'OwningContactAlias': 'v-vibendalam', 'Status': 'RESOLVED'},
{'IncidentId': 694041459, 'Severity': 2, 'OwningContactAlias': 'gbhowal', 'Status': 'RESOLVED'},
{'IncidentId': 694142803, 'Severity': 2, 'OwningContactAlias': 'gbhowal', 'Status': 'RESOLVED'},
{'IncidentId': 694208210, 'Severity': 2, 'OwningContactAlias': 'joalemao', 'Status': 'ACTIVE'},
{'IncidentId': 694253124, 'Severity': 3, 'OwningContactAlias': 'v-susonune', 'Status': 'RESOLVED'},
{'IncidentId': 694613798, 'Severity': 3, 'OwningContactAlias': 'pareshn', 'Status': 'RESOLVED'},
{'IncidentId': 694641794, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 694997702, 'Severity': 3, 'OwningContactAlias': 'v-srikantamr', 'Status': 'RESOLVED'},
{'IncidentId': 695639748, 'Severity': 3, 'OwningContactAlias': 'aniketgupta', 'Status': 'RESOLVED'},
{'IncidentId': 698959989, 'Severity': 3, 'OwningContactAlias': 'kevinan', 'Status': 'RESOLVED'},
{'IncidentId': 701554955, 'Severity': 3, 'OwningContactAlias': '', 'Status': 'RESOLVED'},
{'IncidentId': 703334015, 'Severity': 3, 'OwningContactAlias': 'v-rahulpoli', 'Status': 'RESOLVED'},
{'IncidentId': 703638418, 'Severity': 3, 'OwningContactAlias': 'amulyaeedara', 'Status': 'RESOLVED'},
{'IncidentId': 704121978, 'Severity': 3, 'OwningContactAlias': 'pgarmashov', 'Status': 'RESOLVED'},
{'IncidentId': 704412583, 'Severity': 3, 'OwningContactAlias': 'v-bmacom', 'Status': 'ACTIVE'},
{'IncidentId': 704668547, 'Severity': 3, 'OwningContactAlias': 'diruvalc', 'Status': 'RESOLVED'},
{'IncidentId': 705189268, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 705264335, 'Severity': 3, 'OwningContactAlias': 'olangness', 'Status': 'RESOLVED'},
{'IncidentId': 708806387, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 709609541, 'Severity': 3, 'OwningContactAlias': 'paulofonseca', 'Status': 'RESOLVED'},
{'IncidentId': 710524321, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 710575754, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 710971405, 'Severity': 3, 'OwningContactAlias': '', 'Status': 'RESOLVED'},
{'IncidentId': 711102686, 'Severity': 3, 'OwningContactAlias': 'abhipatel', 'Status': 'RESOLVED'},
{'IncidentId': 712427474, 'Severity': 3, 'OwningContactAlias': 'joibarr', 'Status': 'RESOLVED'},
{'IncidentId': 712435364, 'Severity': 3, 'OwningContactAlias': '', 'Status': 'RESOLVED'},
{'IncidentId': 712466636, 'Severity': 3, 'OwningContactAlias': 'jeastorg', 'Status': 'RESOLVED'},
{'IncidentId': 712728428, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 712920521, 'Severity': 3, 'OwningContactAlias': 'timgriffin', 'Status': 'RESOLVED'},
{'IncidentId': 715492890, 'Severity': 3, 'OwningContactAlias': 'salonievyas', 'Status': 'RESOLVED'},
{'IncidentId': 715869547, 'Severity': 3, 'OwningContactAlias': 'angeo', 'Status': 'RESOLVED'},
{'IncidentId': 717248807, 'Severity': 3, 'OwningContactAlias': 'pareshn', 'Status': 'RESOLVED'},
{'IncidentId': 717527954, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'RESOLVED'},
{'IncidentId': 717584340, 'Severity': 25, 'OwningContactAlias': 'joibarr', 'Status': 'RESOLVED'},
{'IncidentId': 718245595, 'Severity': 3, 'OwningContactAlias': 'v-pparkale', 'Status': 'RESOLVED'},
{'IncidentId': 718445455, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'RESOLVED'},
{'IncidentId': 718828407, 'Severity': 3, 'OwningContactAlias': 'pgarmashov', 'Status': 'MITIGATED'},
{'IncidentId': 719005833, 'Severity': 3, 'OwningContactAlias': 'ramanak', 'Status': 'MITIGATED'},
{'IncidentId': 719540148, 'Severity': 3, 'OwningContactAlias': 'jitheshn', 'Status': 'RESOLVED'},
{'IncidentId': 720295895, 'Severity': 3, 'OwningContactAlias': '', 'Status': 'RESOLVED'},
{'IncidentId': 720584437, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 720978920, 'Severity': 3, 'OwningContactAlias': '', 'Status': 'RESOLVED'},
{'IncidentId': 721235722, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'RESOLVED'},
{'IncidentId': 721306652, 'Severity': 3, 'OwningContactAlias': 'paulofonseca', 'Status': 'RESOLVED'},
{'IncidentId': 721769857, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 722748292, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 723058663, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'RESOLVED'},
{'IncidentId': 723103665, 'Severity': 3, 'OwningContactAlias': 'jarychlik', 'Status': 'RESOLVED'},
{'IncidentId': 723173754, 'Severity': 3, 'OwningContactAlias': 'ekaleksa', 'Status': 'ACTIVE'},
{'IncidentId': 723602044, 'Severity': 3, 'OwningContactAlias': 'ericxu', 'Status': 'ACTIVE'},
{'IncidentId': 724371514, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 724667306, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'RESOLVED'},
{'IncidentId': 725828510, 'Severity': 3, 'OwningContactAlias': 'hevary', 'Status': 'ACTIVE'},
{'IncidentId': 725859865, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 725871688, 'Severity': 3, 'OwningContactAlias': 'hevary', 'Status': 'ACTIVE'},
{'IncidentId': 726186526, 'Severity': 3, 'OwningContactAlias': 'kanikakapoor', 'Status': 'MITIGATED'},
{'IncidentId': 726565549, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'RESOLVED'},
{'IncidentId': 726740695, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'RESOLVED'},
{'IncidentId': 727018861, 'Severity': 3, 'OwningContactAlias': 'paulofonseca', 'Status': 'ACTIVE'},
{'IncidentId': 727649324, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'MITIGATED'},
{'IncidentId': 727947522, 'Severity': 3, 'OwningContactAlias': 'v-vesupriya', 'Status': 'ACTIVE'},
{'IncidentId': 728619885, 'Severity': 3, 'OwningContactAlias': 'timgriffin', 'Status': 'MITIGATED'},
{'IncidentId': 730007060, 'Severity': 3, 'OwningContactAlias': 'v-sattummala', 'Status': 'MITIGATED'},
{'IncidentId': 730114940, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'MITIGATED'},
{'IncidentId': 730544548, 'Severity': 3, 'OwningContactAlias': 'anoliveira', 'Status': 'RESOLVED'},
{'IncidentId': 730561042, 'Severity': 3, 'OwningContactAlias': 'ramanak', 'Status': 'ACTIVE'},
{'IncidentId': 730591118, 'Severity': 3, 'OwningContactAlias': 'anoliveira', 'Status': 'ACTIVE'},
{'IncidentId': 730643690, 'Severity': 3, 'OwningContactAlias': 'surajsingla', 'Status': 'RESOLVED'},
{'IncidentId': 730876102, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 731032830, 'Severity': 3, 'OwningContactAlias': 'v-kamireddib', 'Status': 'RESOLVED'},
{'IncidentId': 731225498, 'Severity': 3, 'OwningContactAlias': 'v-sattummala', 'Status': 'MITIGATED'},
{'IncidentId': 731437222, 'Severity': 3, 'OwningContactAlias': 'maathangik', 'Status': 'MITIGATED'},
{'IncidentId': 731465585, 'Severity': 3, 'OwningContactAlias': 'joibarr', 'Status': 'RESOLVED'},
{'IncidentId': 731474122, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'RESOLVED'},
{'IncidentId': 731554104, 'Severity': 3, 'OwningContactAlias': 'prmarri', 'Status': 'RESOLVED'},
{'IncidentId': 731622085, 'Severity': 3, 'OwningContactAlias': 'yifeiwang', 'Status': 'RESOLVED'},
{'IncidentId': 737402405, 'Severity': 3, 'OwningContactAlias': 'soumi', 'Status': 'MITIGATED'},
{'IncidentId': 737553612, 'Severity': 3, 'OwningContactAlias': '', 'Status': 'ACTIVE'},
{'IncidentId': 21000000851272, 'Severity': 3, 'OwningContactAlias': 'ragogi', 'Status': 'ACTIVE'},
{'IncidentId': 21000000851337, 'Severity': 3, 'OwningContactAlias': 'mayanksahu', 'Status': 'MITIGATED'},
{'IncidentId': 21000000856627, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'MITIGATED'},
{'IncidentId': 21000000856644, 'Severity': 3, 'OwningContactAlias': 'joibarr', 'Status': 'RESOLVED'},
{'IncidentId': 21000000856783, 'Severity': 3, 'OwningContactAlias': 'anoliveira', 'Status': 'RESOLVED'},
{'IncidentId': 21000000857269, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 21000000857404, 'Severity': 3, 'OwningContactAlias': 'kanikakapoor', 'Status': 'ACTIVE'},
{'IncidentId': 21000000860434, 'Severity': 3, 'OwningContactAlias': 'anoliveira', 'Status': 'RESOLVED'},
{'IncidentId': 21000000862533, 'Severity': 3, 'OwningContactAlias': 'fainazv', 'Status': 'ACTIVE'},
{'IncidentId': 21000000865273, 'Severity': 3, 'OwningContactAlias': 'vishveshjani', 'Status': 'ACTIVE'},
{'IncidentId': 21000000865306, 'Severity': 3, 'OwningContactAlias': 'rexzh', 'Status': 'MITIGATED'},
{'IncidentId': 21000000868545, 'Severity': 3, 'OwningContactAlias': 'anoliveira', 'Status': 'RESOLVED'},
{'IncidentId': 21000000868738, 'Severity': 3, 'OwningContactAlias': 'salonievyas', 'Status': 'RESOLVED'},
{'IncidentId': 21000000872879, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'MITIGATED'},
{'IncidentId': 21000000873773, 'Severity': 3, 'OwningContactAlias': 'anoliveira', 'Status': 'RESOLVED'},
{'IncidentId': 21000000873960, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'ACTIVE'},
{'IncidentId': 21000000874156, 'Severity': 3, 'OwningContactAlias': 'kanikakapoor', 'Status': 'MITIGATED'},
{'IncidentId': 21000000876055, 'Severity': 3, 'OwningContactAlias': 'kchopra', 'Status': 'RESOLVED'},
{'IncidentId': 21000000876868, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'MITIGATED'},
{'IncidentId': 21000000878209, 'Severity': 3, 'OwningContactAlias': 'amanjha', 'Status': 'MITIGATED'},
{'IncidentId': 21000000878979, 'Severity': 3, 'OwningContactAlias': 'anoliveira', 'Status': 'ACTIVE'},
{'IncidentId': 51000000779414, 'Severity': 4, 'OwningContactAlias': '', 'Status': 'RESOLVED'},
{'IncidentId': 51000000792170, 'Severity': 3, 'OwningContactAlias': 'chrwarren', 'Status': 'ACTIVE'},
{'IncidentId': 51000000852988, 'Severity': 3, 'OwningContactAlias': '', 'Status': 'ACTIVE'},
{'IncidentId': 51000000857946, 'Severity': 3, 'OwningContactAlias': 'sourpandey', 'Status': 'RESOLVED'},
{'IncidentId': 51000000859513, 'Severity': 3, 'OwningContactAlias': 'syazicioglu', 'Status': 'ACTIVE'},
{'IncidentId': 51000000862320, 'Severity': 25, 'OwningContactAlias': 'kevinrey', 'Status': 'ACTIVE'},
{'IncidentId': 51000000864264, 'Severity': 3, 'OwningContactAlias': 'v-srikantamr', 'Status': 'RESOLVED'},
{'IncidentId': 51000000864326, 'Severity': 3, 'OwningContactAlias': 'timgriffin', 'Status': 'RESOLVED'},
{'IncidentId': 51000000865253, 'Severity': 3, 'OwningContactAlias': 'v-rpaturi', 'Status': 'RESOLVED'},
{'IncidentId': 51000000865629, 'Severity': 3, 'OwningContactAlias': 'joibarr', 'Status': 'RESOLVED'},
{'IncidentId': 51000000875881, 'Severity': 3, 'OwningContactAlias': 'anoliveira', 'Status': 'ACTIVE'},
{'IncidentId': 51000000877183, 'Severity': 3, 'OwningContactAlias': 'sonalsagar', 'Status': 'RESOLVED'},
{'IncidentId': 51000000879655, 'Severity': 3, 'OwningContactAlias': 'ronmustard', 'Status': 'MITIGATED'},
{'IncidentId': 51000000879698, 'Severity': 3, 'OwningContactAlias': 'jasheridan', 'Status': 'RESOLVED'},
{'IncidentId': 51000000883229, 'Severity': 3, 'OwningContactAlias': 'sonalsagar', 'Status': 'ACTIVE'}
]

df = pd.DataFrame(icm_data)
df = df.rename(columns={'OwningContactAlias': 'IcmOwner', 'Status': 'IcmStatus', 'Severity': 'IcmSeverity'})
df.to_csv('data/icm.csv', index=False)

print(f'âœ“ Updated ICM data: {len(df)} ICMs (filtered out SCIM Escalation Management)')
print(f'\nStatus breakdown:')
print(df['IcmStatus'].value_counts())
owners_with_data = (df['IcmOwner'] != '').sum()
print(f'\nICMs with owners: {owners_with_data} of {len(df)} ({owners_with_data / len(df) * 100:.1f}%)')
