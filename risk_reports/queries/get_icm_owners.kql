
let ICMIds = datatable(IncidentId:long)
[
    21000000851272,
    21000000856644,
    21000000857269,
    21000000860434,
    21000000862533,
    21000000863466,
    21000000865306,
    21000000868738,
    21000000872879,
    21000000873960,
    21000000874156,
    21000000876055,
    21000000876868,
    21000000878209,
    21000000890259,
    51000000779414,
    51000000859513,
    51000000862320,
    51000000864264,
    51000000865629,
    51000000865974,
    51000000875881,
    51000000877183,
    51000000883229,
    51000000887600,
    554844287,
    616515906,
    628032426,
    670828774,
    676151538,
    680275765,
    686606637,
    687188371,
    692107101,
    693543577,
    693849812,
    693952482,
    694041459,
    694142803,
    694208210,
    694253124,
    694613798,
    694641794,
    694997702,
    695639748,
    698959989,
    703334015,
    703638418,
    704412583,
    704668547,
    705189268,
    709609541,
    710524321,
    712466636,
    712728428,
    712920521,
    715492890,
    715869547,
    717248807,
    717527954,
    718245595,
    718445455,
    720089608,
    720295895,
    720584437,
    720978920,
    721306652,
    722748292,
    723058663,
    724667306,
    725859865,
    727018861,
    727649324,
    727947522,
    730007060,
    730114940,
    730643690,
    730876102,
    731032830,
    731225498,
    731437222,
    731465585,
    731474122,
    737553612,
    743458352,
];
cluster('icmcluster').database('IcmDataWarehouse').Incidents
| where IncidentId in (ICMIds)
| summarize arg_max(ModifiedDate, *) by IncidentId
| join kind=leftouter (
    cluster('icmcluster').database('IcmDataWarehouse').IncidentBugs
    | where IncidentId in (ICMIds)
    | where IsTombstoned == false
    | summarize 
        BugIds = strcat_array(make_set(BugId), ','),
        BugExternalIds = strcat_array(make_set(ExternalId), ','),
        BugDescriptions = strcat_array(make_set(Description), '; '),
        BugStatuses = strcat_array(make_set(Status), ',')
    by IncidentId
) on IncidentId
| project 
    IncidentId,
    IcmOwner = OwningContactAlias,
    IcmStatus = Status,
    IcmSeverity = Severity,
    OwningTenantName,
    OwningTeamName,
    Title,
    ModifiedDate,
    BugIds,
    BugExternalIds,
    BugDescriptions,
    BugStatuses
| order by IncidentId asc
